{"version":3,"file":"WindowsController.js","sourceRoot":"","sources":["WindowsController.ts"],"names":[],"mappings":"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","sourcesContent":["import { MongoContextFactory } from \"./schema\";\r\nimport { RatedEntitieBase } from \"./entities/RatedEntitieBase\";\r\nimport { ApplicantEntity } from \"./entities/ApplicantEntity\";\r\nimport { CommentableEntitieBase } from \"./entities/CommentableEntitieBase\";\r\nimport { JobEntitie } from \"./entities/JobEntitie\";\r\n\r\nclass WindowsController\r\n{\r\n\tprivate Factory: MongoContextFactory;\r\n\r\n\tprivate StateInput: HTMLSpanElement;\r\n\r\n\tprivate _cmbAges: HTMLSelectElement;\r\n\tprivate _cmbFams: HTMLSelectElement;\r\n\tprivate _cmbStuds: HTMLSelectElement;\r\n\tprivate _cmbExps: HTMLSelectElement;\r\n\tprivate _txtComment: HTMLTextAreaElement;\r\n\tprivate _txtStudComment: HTMLTextAreaElement;\r\n\tprivate _txtExpComment: HTMLTextAreaElement;\r\n\tprivate _txtFio: HTMLInputElement;\r\n\tprivate _lstStuds: HTMLDivElement;\r\n\tprivate _lstExps: HTMLDivElement;\r\n\r\n\tprivate Applicant: ApplicantEntity;\r\n\r\n\tconstructor(factory: MongoContextFactory)\r\n\t{\r\n\t\tthis.Factory    = factory;\r\n\t\tthis.StateInput = document.querySelector('[data-id=\"state\"]');\r\n\t}\r\n\r\n\tpublic async ShowStartDialog()\r\n\t{\r\n\t\tlet node = (document\r\n\t\t\t.querySelector(\"#startDialog\") as HTMLTemplateElement)\r\n\t\t\t.content\r\n\t\t\t.cloneNode(true);\r\n\r\n\t\tthis.StateInput.textContent = \"Инициализация шаблона страницы...\";\r\n\t\tthis.SetPage(node);\r\n\t\tthis.StateInput.textContent = \"Привязка полей\";\r\n\t\tthis.BindFields();\r\n\t\tthis.StateInput.textContent = \"Привязка кнопок\";\r\n\t\tthis.BindButtons();\r\n\r\n\t\ttry\r\n\t\t{\r\n\t\t\tthis.StateInput.textContent = \"Инициализация полей формы...\";\r\n\t\t\tawait this.FillInputs();\r\n\t\t}\r\n\t\tcatch(exc)\r\n\t\t{\r\n\t\t\tconsole.error(exc);\r\n\t\t\tthis.StateInput.textContent += \" Ошибка\";\r\n\t\t}\r\n\r\n\t\tthis.StateInput.textContent = \"Готово\";\r\n\t}\r\n\r\n\tprivate SetPage(element: Node)\r\n\t{\r\n\t\tlet body = document.querySelector(\"#mainContainer\");\r\n\t\twhile(body.firstChild)\r\n\t\t{\r\n\t\t\tbody.removeChild(body.firstChild);\r\n\t\t}\r\n\t\tbody.appendChild(element);\r\n\t}\r\n\r\n\tprivate BindFields()\r\n\t{\r\n\t\tthis._cmbAges        = document.querySelector(\"#_cmbAge\");\r\n\t\tthis._cmbFams        = document.querySelector(\"#_cmbFam\");\r\n\t\tthis._cmbStuds       = document.querySelector(\"#_cmbStud\");\r\n\t\tthis._cmbExps        = document.querySelector(\"#_cmbExp\");\r\n\t\tthis._txtComment     = document.querySelector(\"#_txtComment\");\r\n\t\tthis._txtStudComment = document.querySelector(\"#_txtStudComment\");\r\n\t\tthis._txtExpComment  = document.querySelector(\"#_txtExpComment\");\r\n\t\tthis._txtFio         = document.querySelector(\"#_txtFio\");\r\n\t\tthis._lstStuds       = document.querySelector(\"#_lstStuds\");\r\n\t\tthis._lstExps        = document.querySelector(\"#_lstExps\");\r\n\t}\r\n\r\n\tprivate BindButtons()\r\n\t{\r\n\t\tdocument.querySelector(\"#_btnNewStud\").addEventListener('click',\r\n\t\t\t() => this.ShowDialog(\"_wndNewStud\"));\r\n\t\tdocument.querySelector(\"#_btnNewExp\").addEventListener('click',\r\n\t\t\t() => this.ShowDialog(\"_wndNewExp\"));\r\n\r\n\t\tdocument.querySelectorAll(\"[data-action='cancel']\").forEach(\r\n\t\t\t(x: HTMLElement) => x.addEventListener('click',\r\n\t\t\t\t() => this.CloseDialog(x.dataset.dialogId)));\r\n\r\n\t\tdocument.querySelector(\"#_wndNewExp [data-action='ok']\").addEventListener('click',\r\n\t\t\t() => this.SaveExp(\"_wndNewExp\"));\r\n\t\tdocument.querySelector(\"#_wndNewStud [data-action='ok']\").addEventListener('click',\r\n\t\t\t() => this.SaveStud(\"_wndNewStud\"));\r\n\r\n\t\tdocument.querySelector(\".btn.next.fixed\").addEventListener('click',\r\n\t\t\t() => this.OpenTest());\r\n\t}\r\n\r\n\tprivate async FillInputs()\r\n\t{\r\n\t\tthis.StateInput.textContent = \"Инициализация поля возрастов...\";\r\n\t\tlet ages                    = await this.Factory.SelectAsync<RatedEntitieBase>(\r\n\t\t\tthis.Factory.AgeModel,\r\n\t\t\tRatedEntitieBase,\r\n\t\t\t{});\r\n\r\n\t\tages.forEach(x =>\r\n\t\t{\r\n\t\t\tlet element           = document.createElement('option');\r\n\t\t\telement.dataset.id    = x.Id;\r\n\t\t\telement.dataset.rate  = x.Rate.toString();\r\n\t\t\telement.dataset.value = x.Value;\r\n\t\t\telement.textContent   = x.Value;\r\n\r\n\t\t\tthis._cmbAges.add(element);\r\n\t\t});\r\n\r\n\t\tthis.StateInput.textContent = \"Инициализация поля семейного положения...\";\r\n\t\tlet fams                    = await this.Factory.SelectAsync<RatedEntitieBase>(\r\n\t\t\tthis.Factory.FamModel,\r\n\t\t\tRatedEntitieBase,\r\n\t\t\t{});\r\n\r\n\t\tfams.forEach(x =>\r\n\t\t{\r\n\t\t\tlet element           = document.createElement('option');\r\n\t\t\telement.dataset.id    = x.Id;\r\n\t\t\telement.dataset.rate  = x.Rate.toString();\r\n\t\t\telement.dataset.value = x.Value;\r\n\t\t\telement.textContent   = x.Value;\r\n\r\n\t\t\tthis._cmbFams.add(element);\r\n\t\t});\r\n\r\n\t\tthis.StateInput.textContent = \"Инициализация поля типов образования...\";\r\n\t\tlet studs                   = await this.Factory.SelectAsync<RatedEntitieBase>(\r\n\t\t\tthis.Factory.StudModel,\r\n\t\t\tRatedEntitieBase,\r\n\t\t\t{});\r\n\r\n\t\tstuds.forEach(x =>\r\n\t\t{\r\n\t\t\tlet element           = document.createElement('option');\r\n\t\t\telement.dataset.id    = x.Id;\r\n\t\t\telement.dataset.rate  = x.Rate.toString();\r\n\t\t\telement.dataset.value = x.Value;\r\n\t\t\telement.textContent   = x.Value;\r\n\r\n\t\t\tthis._cmbStuds.add(element);\r\n\t\t});\r\n\r\n\t\tthis.StateInput.textContent = \"Инициализация поля типов опыта...\";\r\n\t\tlet exps                    = await this.Factory.SelectAsync<RatedEntitieBase>(\r\n\t\t\tthis.Factory.ExpModel,\r\n\t\t\tRatedEntitieBase,\r\n\t\t\t{});\r\n\r\n\t\texps.forEach(x =>\r\n\t\t{\r\n\t\t\tlet element           = document.createElement('option');\r\n\t\t\telement.dataset.id    = x.Id;\r\n\t\t\telement.dataset.rate  = x.Rate.toString();\r\n\t\t\telement.dataset.value = x.Value;\r\n\t\t\telement.textContent   = x.Value;\r\n\r\n\t\t\tthis._cmbExps.add(element);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate SaveStud(id: string)\r\n\t{\r\n\t\tthis.StateInput.textContent = \"Сохранение результата диалога...\";\r\n\t\tlet node                    = document.createElement('DIV');\r\n\t\tnode.dataset.id             = this._cmbStuds.selectedOptions[0].dataset.id;\r\n\t\tnode.dataset.rate           = this._cmbStuds.selectedOptions[0].dataset.rate;\r\n\t\tnode.dataset.comment        = this._txtStudComment.value;\r\n\t\tnode.textContent            = node.dataset.value = this._cmbStuds.selectedOptions[0].dataset.value;\r\n\r\n\t\tthis._lstStuds.appendChild(node);\r\n\t\tthis.CloseDialog(id);\r\n\t}\r\n\r\n\tprivate SaveExp(id: string)\r\n\t{\r\n\t\tthis.StateInput.textContent = \"Сохранение результата диалога...\";\r\n\t\tlet node                    = document.createElement('DIV');\r\n\t\tnode.dataset.id             = this._cmbExps.selectedOptions[0].dataset.id;\r\n\t\tnode.dataset.rate           = this._cmbExps.selectedOptions[0].dataset.rate;\r\n\t\tnode.dataset.comment        = this._txtExpComment.value;\r\n\t\tnode.textContent            = node.dataset.value = this._cmbExps.selectedOptions[0].dataset.value;\r\n\r\n\t\tthis._lstExps.appendChild(node);\r\n\t\tthis.CloseDialog(id);\r\n\t}\r\n\r\n\tprivate async OpenTest()\r\n\t{\r\n\t\tthis.StateInput.textContent = \"Сохранение результатов анкетирования...\";\r\n\t\tlet studies                 = [...this._lstStuds\r\n\t\t\t.children]\r\n\t\t\t.map(\r\n\t\t\t\t(x: HTMLElement) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tlet stud = new RatedEntitieBase(x.textContent, Number.parseInt(x.dataset.rate));\r\n\t\t\t\t\tstud.Id  = x.dataset.id;\r\n\r\n\t\t\t\t\treturn new CommentableEntitieBase(stud, x.dataset.comment);\r\n\t\t\t\t});\r\n\r\n\t\tlet exps = [...this._lstExps\r\n\t\t\t.children]\r\n\t\t\t.map(\r\n\t\t\t\t(x: HTMLElement) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tlet stud = new RatedEntitieBase(x.textContent, Number.parseInt(x.dataset.rate));\r\n\t\t\t\t\tstud.Id  = x.dataset.id;\r\n\r\n\t\t\t\t\treturn new CommentableEntitieBase(stud, x.dataset.comment);\r\n\t\t\t\t});\r\n\r\n\t\tlet option = this._cmbAges.selectedOptions[0];\r\n\t\tlet age    = new RatedEntitieBase(option.textContent, Number.parseInt(option.dataset.rate));\r\n\t\tage.Id     = option.dataset.id;\r\n\r\n\t\toption  = this._cmbFams.selectedOptions[0];\r\n\t\tlet fam = new RatedEntitieBase(option.textContent, Number.parseInt(option.dataset.rate));\r\n\t\tage.Id  = option.dataset.id;\r\n\r\n\t\tthis.Applicant = new ApplicantEntity(\r\n\t\t\tthis._txtFio.value,\r\n\t\t\tage,\r\n\t\t\tstudies,\r\n\t\t\texps,\r\n\t\t\tfam,\r\n\t\t\tthis._txtComment.value,\r\n\t\t\tthis.CalcInitialRate(age, fam, studies, exps),\r\n\t\t\t0,\r\n\t\t\t0,\r\n\t\t\t0,\r\n\t\t);\r\n\r\n\t\tthis.StateInput.textContent = \"Запуск тестирования...\";\r\n\t\tlet testPage                = (document.querySelector(\"#testDialog\") as HTMLTemplateElement)\r\n\t\t\t.content\r\n\t\t\t.cloneNode(true);\r\n\r\n\t\tthis.SetPage(testPage);\r\n\t\tthis.BindRadioButtons();\r\n\t\tthis.StateInput.textContent = \"Готово\";\r\n\t}\r\n\r\n\tprivate BindRadioButtons()\r\n\t{\r\n\t\tlet qestions = document.querySelectorAll(\".question\");\r\n\t\tlet isFetchingStarted: boolean;\r\n\r\n\t\tqestions.forEach((q: HTMLElement, index) =>\r\n\t\t{\r\n\t\t\tlet radBtns     = q.querySelectorAll(\"input[type='radio']\");\r\n\t\t\tlet qType       = q.dataset.type;\r\n\t\t\tlet qConfidence = Number.parseInt(q.dataset.rating);\r\n\r\n\t\t\tradBtns.forEach((rb: HTMLInputElement) =>\r\n\t\t\t{\r\n\t\t\t\tlet answConfidence = Number.parseInt(rb.value);\r\n\r\n\t\t\t\trb.addEventListener('click',\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tswitch(qType)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcase \"bisnes\":\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlet conditionRate         = this.CalcAndOperation(answConfidence, qConfidence);\r\n\t\t\t\t\t\t\t\tthis.Applicant.BisnesRate =\r\n\t\t\t\t\t\t\t\t\tthis.CalcOrOperation(this.Applicant.BisnesRate, conditionRate);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase \"psyco\":\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlet conditionRate        = this.CalcAndOperation(answConfidence, qConfidence);\r\n\t\t\t\t\t\t\t\tthis.Applicant.PsycoRate =\r\n\t\t\t\t\t\t\t\t\tthis.CalcOrOperation(this.Applicant.PsycoRate, conditionRate);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcase \"prof\":\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlet conditionRate       = this.CalcAndOperation(answConfidence, qConfidence);\r\n\t\t\t\t\t\t\t\tthis.Applicant.ProfRate =\r\n\t\t\t\t\t\t\t\t\tthis.CalcOrOperation(this.Applicant.ProfRate, conditionRate);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(index != qestions.length - 1)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tq.classList.remove('current');\r\n\t\t\t\t\t\t\tqestions[index + 1].classList.add('current');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif(!isFetchingStarted)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tisFetchingStarted = true;\r\n\r\n\t\t\t\t\t\t\t\tthis.Applicant.Rate =\r\n\t\t\t\t\t\t\t\t\tMath.min(this.Applicant.Rate, this.Applicant.PsycoRate, this.Applicant.BisnesRate,\r\n\t\t\t\t\t\t\t\t\t\tthis.Applicant.ProfRate);\r\n\r\n\t\t\t\t\t\t\t\tthis.ShowAllowedJobs();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate async ShowAllowedJobs()\r\n\t{\r\n\t\tthis.StateInput.textContent = \"Поиск вакансий...\";\r\n\t\tlet jobs                    = await this.Factory.SelectAsync<JobEntitie>(this.Factory.JobModel, JobEntitie, {});\r\n\r\n\t\tthis.StateInput.textContent = \"Поиск подходящих вакансий...\";\r\n\t\tlet calcJobs                = jobs.map(x =>\r\n\t\t{\r\n\t\t\tlet rate = Math.max(x.Payment.Rate, x.MinRate, x.Experience.Rate, x.Studie.Rate, x.Family.Rate, x.Age.Rate);\r\n\t\t\treturn {\r\n\t\t\t\tId:         x.Id,\r\n\t\t\t\tName:       x.Name,\r\n\t\t\t\tPayment:    x.Payment.Value,\r\n\t\t\t\tEmployment: x.Employment,\r\n\t\t\t\tComment:    x.Comment,\r\n\t\t\t\tRate:       rate,\r\n\t\t\t};\r\n\t\t});\r\n\r\n\t\tlet allowedJobs = calcJobs.filter(x => x.Rate <= this.Applicant.Rate);\r\n\r\n\t\tlet showFinal = () =>\r\n\t\t{\r\n\t\t\tlet jobsPage = (document.querySelector(\"#noChance\") as HTMLTemplateElement)\r\n\t\t\t\t.content\r\n\t\t\t\t.cloneNode(true);\r\n\r\n\t\t\tthis.SetPage(jobsPage);\r\n\t\t};\r\n\r\n\t\tif(!allowedJobs.length)\r\n\t\t{\r\n\t\t\tshowFinal();\r\n\t\t\tthis.StateInput.textContent = \"Готово\";\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet jobsPage = (document.querySelector(\"#allowedJobsDialog\") as HTMLTemplateElement)\r\n\t\t\t.content\r\n\t\t\t.cloneNode(true);\r\n\t\tthis.SetPage(jobsPage);\r\n\r\n\t\tlet jobTemplate   = (document.querySelector(\"#job\") as HTMLTemplateElement)\r\n\t\t\t.content;\r\n\t\tlet jobsContainer = document.querySelector(\".jobs\");\r\n\r\n\t\tallowedJobs.forEach(x =>\r\n\t\t{\r\n\t\t\tlet job = jobTemplate.cloneNode(true) as HTMLElement;\r\n\r\n\t\t\tjob.querySelector('input').value = x.Id;\r\n\t\t\tjob.querySelector('[data-id=\"Name\"]').textContent += x.Name;\r\n\t\t\tjob.querySelector('[data-id=\"Payment\"]').textContent += x.Payment;\r\n\t\t\tjob.querySelector('[data-id=\"Employment\"]').textContent += x.Employment;\r\n\t\t\tjob.querySelector('[data-id=\"Comment\"]').textContent += x.Comment;\r\n\r\n\t\t\tjobsContainer.appendChild(job);\r\n\t\t});\r\n\r\n\t\tdocument.querySelector(\".btn.next.fixed\").addEventListener('click', () =>\r\n\t\t{\r\n\t\t\tlet ids = [...jobsContainer.querySelectorAll('input')]\r\n\t\t\t\t.filter(x => x.checked)\r\n\t\t\t\t.map(x => x.value);\r\n\r\n\t\t\tif(ids.length)\r\n\t\t\t{\r\n\t\t\t\tthis.PushApplicant(ids);\r\n\t\t\t}\r\n\r\n\t\t\tshowFinal();\r\n\t\t});\r\n\r\n\t\tthis.StateInput.textContent = \"Готово\";\r\n\t}\r\n\r\n\tprivate async PushApplicant(jobsIds: string[])\r\n\t{\r\n\t\tlet applicant = this.Applicant;\r\n\t\tapplicant.Jobs = jobsIds.map(x =>\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tId: x,\r\n\t\t\t};\r\n\t\t}) as JobEntitie[];\r\n\r\n\t\t//TODO: исправить баг в represent при сохраннении соискателя. Поля не совпадают\r\n\r\n\t\t//let applicantModel = new this.Factory.ApplicantModel(applicant.ToDbEntry());\r\n\t\t//let dbApplicant = await this.Factory.SaveAsync(applicantModel, ApplicantEntity.Represent);\r\n\t}\r\n\r\n\tprivate CalcAndOperation(cfA: number, cfB: number): number\r\n\t{\r\n\t\tif(cfA == 100)\r\n\t\t{\r\n\t\t\treturn cfB;\r\n\t\t}\r\n\r\n\t\treturn cfA * cfB / 100;\r\n\t}\r\n\r\n\tprivate CalcOrOperation(cfA: number, cfB: number): number\r\n\t{\r\n\t\treturn cfA + cfB - cfA * cfB / 100;\r\n\t}\r\n\r\n\tprivate CalcInitialRate(age: RatedEntitieBase,\r\n\t\t\t\t\t\t\tfam: RatedEntitieBase,\r\n\t\t\t\t\t\t\tstuds: CommentableEntitieBase[],\r\n\t\t\t\t\t\t\texps: CommentableEntitieBase[]): number\r\n\t{\r\n\t\tlet rates = studs.map(x => this.CalcOrOperation(x.RatedEntitie.Rate, 70));\r\n\t\tlet studRate = Math.max.apply(null, rates);\r\n\t\trates = exps.map(x => this.CalcOrOperation(x.RatedEntitie.Rate, 30));\r\n\t\tlet expRate = Math.max.apply(null, rates);\r\n\r\n\t\treturn Math.max(age.Rate,\r\n\t\t\tfam.Rate,\r\n\t\t\tstudRate,\r\n\t\t\texpRate);\r\n\t}\r\n\r\n\tprivate ShowDialog(id: string)\r\n\t{\r\n\t\tthis.StateInput.textContent = \"Открытие диалога...\";\r\n\t\tdocument.querySelector(\"body\").classList.add(\"dialogMode\");\r\n\t\tdocument.querySelector(\"#dialog\").classList.remove(\"hidden\");\r\n\t\tdocument.querySelector(\"#dialog #\" + id).classList.remove(\"hidden\");\r\n\t\tthis.StateInput.textContent = \"Готово\";\r\n\t}\r\n\r\n\tprivate CloseDialog(id: string)\r\n\t{\r\n\t\tthis.StateInput.textContent = \"Закрытие диалога...\";\r\n\t\tdocument.querySelector(\"body\").classList.remove(\"dialogMode\");\r\n\t\tdocument.querySelector(\"#dialog\").classList.add(\"hidden\");\r\n\t\tdocument.querySelector(\"#dialog #\" + id).classList.add(\"hidden\");\r\n\t\tthis.StateInput.textContent = \"Готово\";\r\n\t}\r\n}\r\n\r\nexport { WindowsController };"]}